{"version":3,"file":"yarn.js","sourceRoot":"","sources":["../../src/main/yarn.ts"],"names":[],"mappings":"AAAA,OAAO,EAAgB,KAAK,EAAE,MAAM,eAAe,CAAC;AACpD,OAAO,EAAE,IAAI,EAAE,MAAM,aAAa,CAAC;AAEnC,MAAM,CAAC,MAAM,uBAAuB,GAAG,KAAK,IAAI,EAAE;IAChD,MAAM,iBAAiB,GAAG,MAAM,iBAAiB,EAAE,CAAC;IACpD,IAAI,CAAC,iBAAiB,EAAE;QACtB,MAAM,eAAe,EAAE,CAAC;KACzB;AACH,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,iBAAiB,GAAG,KAAK,IAAI,EAAE;IAC1C,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,CAAC;IACzC,OAAO,KAAK,CAAC,WAAW,EAAE,IAAI,KAAK,CAAC,cAAc,EAAE,CAAC;AACvD,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,eAAe,GAAG,KAAK,IAAI,EAAE,CACxC,WAAW,CAAC,MAAM,EAAE,CAAC,SAAS,EAAE,aAAa,EAAE,mBAAmB,CAAC,EAAE;IACnE,KAAK,EAAE,SAAS;IAChB,WAAW,EAAE,IAAI;CAClB,CAAC,CAAC;AAEL,MAAM,WAAW,GAAG,CAClB,OAAe,EACf,IAAuB,EACvB,OAAqB,EACN,EAAE,CACjB,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;IAC9B,MAAM,KAAK,GAAG,KAAK,CAAC,OAAO,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;IAC5C,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;IAC1B,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;AAC7B,CAAC,CAAC,CAAC","sourcesContent":["import { SpawnOptions, spawn } from \"child_process\";\nimport { stat } from \"fs/promises\";\n\nexport const ensurePackagesInstalled = async () => {\n  const shouldSkipInstall = await nodeModulesExists();\n  if (!shouldSkipInstall) {\n    await installPackages();\n  }\n};\n\nexport const nodeModulesExists = async () => {\n  const stats = await stat(\"node_modules\");\n  return stats.isDirectory() || stats.isSymbolicLink();\n};\n\nexport const installPackages = async () =>\n  spawnSimple(\"yarn\", [\"install\", \"--immutable\", \"--immutable-cache\"], {\n    stdio: \"inherit\",\n    windowsHide: true,\n  });\n\nconst spawnSimple = (\n  command: string,\n  args: readonly string[],\n  options: SpawnOptions,\n): Promise<void> =>\n  new Promise((resolve, reject) => {\n    const child = spawn(command, args, options);\n    child.on(\"error\", reject);\n    child.on(\"close\", resolve);\n  });\n"]}